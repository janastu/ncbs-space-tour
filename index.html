<!--Virtual Tour of Obaid Siddiqi's Lab.
Uses Pannellum https://pannellum.org/ and routie http://projects.jga.me/routie/ -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
	    <title>NCBS 25</title>
	    <link rel="icon" href="img/Assets/ncbs_logo_header.png" type="image/png" sizes="16x16">
	    <meta name="description" content="" />
	    <meta name="author" content="" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link type="text/css" rel="stylesheet" href="src/css/bootstrap.css" />
		<link type="text/css" rel="stylesheet" href="src/css/header.css" />
		<link type="text/css" rel="stylesheet" href="src/css/main.css" />
        <link rel="stylesheet" href="src/js/font-awesome-4.6.3/css/font-awesome.min.css">
        <link type="text/css" rel="stylesheet" href="src/css/imageviewer.css" />

	<link rel="stylesheet" href="src/css/pannellum.css"/>

    <link rel="stylesheet" href="src/css/content.css"/>


    <script type="text/javascript" src="src/js/jquery.min.js"></script>

    <script type="text/javascript" src="src/js/bootstrap.min.js"></script>

    <script type="text/javascript" src="src/js/routie.js"></script>

    <script type="text/javascript" src="src/js/classie.js"></script>
    <script type="text/javascript" src="src/js/imageviewer.min.js"></script>



    <script type="text/javascript" src="src/js/underscore-min.js"></script>



    <script type="text/javascript" src="src/js/pannellum.js"></script>
    <script type="text/javascript" src="src/js/libpannellum.js"></script>
    <script type="text/javascript" src="src/js/RequestAnimationFrame.js"></script>

    <script type="text/javascript" src="data.js"></script>

    <script type="text/javascript" src="src/js/modernizr.webgl.js"></script>

</head>







<script type="text/javascript">
        function scrollEffect(){

            window.addEventListener('scroll', function(e){
            var distanceY = window.pageYOffset || document.documentElement.scrollTop,
                shrinkOn = 25,
                header = document.querySelector("header");
            if (distanceY > shrinkOn) {
                classie.add(header,"smaller");
                //$("#ncbs-home-text-collapsible").hide();
            } else {
                //$("#ncbs-home-text-collapsible").show();
                if (classie.has(header,"smaller")) {
                    classie.remove(header,"smaller");
                }
            }
        });
        };

scrollEffect();

</script>


<body>

<!--Header-->
<div class="container-fluid">
        <div class="row-fluid">
            <!-- Header from templates/header.html and app.js -->

<header>
    <div class="container clearfix">
        <h1 id="logo">
          <a href="https://www.ncbs.res.in/ncbs25/" target="">
            <img src="img/Assets/ncbs_logo_introtext.png" alt="LOGO" />
          </a>
        </h1>
        <nav class=" pull-right" style="margin-right: 1.5em;">
            <ul class="nav navbar-nav navbar-right">
                </ul>
                  <a href="https://www.ncbs.res.in/ncbs25/#about" target="">About</a>
                  <a href="https://www.ncbs.res.in/" target="_blank">NCBS</a>


        </nav>
    </div>
</header><!-- /header -->
<ul class="nav nabar-nav" style=" position: fixed;
    right: 3%; top:8px; font-weight:600;
    z-index: 1000; ">
      <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" style="color: white; font-size:18px;">Sandbox <span style="border-top-color:#fff;" class="caret"></span></a>
<ul class="dropdown-menu" style="background-color:rgba(102, 102, 102, 0.2); color:white; border-radius:0px; margin-top:14px;">
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/ephemera">Ephemera</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/peopleplex">Peopleplex</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/space_tour">Space Tour</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/timeline">Timeline</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/oral_history">Oral History</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="https://www.ncbs.res.in/ncbs25/sandbox/mosaic">Mosaic template</a></li>
  </ul>
</li>
</ul></div>
</div>
<!-- /header -->






                <div id='intro'>
                    <div id = 'close-intro'>X</div>
	               <h4><br><br><b>Space Tour</b> offers a mash-up of oral histories, archival documents and contemporary spatial mapping techniques. The current tour is Obaid Siddiqi's office and lab, with the memories of Deepti Trivedi, a former student. Click on the information icon and arrows to navigate. Future developments will layer other people's memories and will be tours of other places.</h4>
                   </div>
            </div>



<!--Panorama-->
<div id='panorama'>

                <!-- Narration-->
                <div id="narration" class="narration">
                    <!--Title-->
                    <div id="title" class="title-text">

                    </div>
                    <div id="contents">

                    </div>
                    <!-- Close button -->
                    <div id="close">
                        <center>X</center>
                    </div>

                </div>
                <div id='audio-bar'></div>
            </div>




<!-- footer -->
<div class="row-fluid">
    <div class="col-md-12">

        <div id="footer">


<div class="row" id="ncbs-nav-footer">
    <div class="col-lg-offset-1">
        <div style="font-family: roboto;font-size: 24px;margin: 2px; color:#333726;">
             <p>THEMES</p>
</div>
</div>
    <div class="col-lg-offset-1" style="display:flex;">

    <a href="https://www.ncbs.res.in/ncbs25/#identity" target="">
    <div class="panel panel-ncbs-foot">
         <div class="panel-body">
            <div class="sub-theme-nav-item">

                    <img src="img/Assets/identity.png" alt="category_identity" class="img-thumbnail" />


            </div>
        </div>
    </div>
    <div class="ncbs-foot-nav-text  text-center">Identity</div>
    </a>

    <a href="https://www.ncbs.res.in/ncbs25/#institution-building" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">

                        <img src="img/Assets/Institution_Building.png" alt="category_Institution_Building" class="img-thumbnail" style="margin-top:-5px;"/>

                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text  text-center">Institution Building</div>
        </a>
        <a href="https://www.ncbs.res.in/ncbs25/#growth" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">

                   <img src="img/Assets/growth.png" alt="category_growth" class="img-thumbnail" style="margin-top:-5px; width:93px; margin-left:17px;"/>


                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text   text-center">Growth</div>
        </a>
        <a href="https://www.ncbs.res.in/ncbs25/#research" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">
                    <img src="img/Assets/research-1.png" alt="category_research" class="img-thumbnail" style="width: 90px; margin-left: 15px;"/>
                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text  text-center">Research</div>
        </a>
        <a href="https://www.ncbs.res.in/ncbs25/#education" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">
                    <img src="img/Assets/education.png" alt="category_education" class="img-thumbnail" style="margin-top:26px;"/>
                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text  text-center">Education</div>
        </a>
        <a href="https://www.ncbs.res.in/ncbs25/#ripple-effect" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">

                    <img src="img/Assets/ripple_effect.png" alt="category_ripple_effect" class="img-thumbnail" style="margin-top:-7px;"/>

                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text  text-center">Ripple Effect</div>
        </a>
        <a href="https://www.ncbs.res.in/ncbs25/#intersections" target="">
        <div class="panel panel-ncbs-foot">
             <div class="panel-body">
                <div class="sub-theme-nav-item">

                    <img src="img/Assets/intersections.png" alt="category_intersections" class="img-thumbnail"/>

                </div>
            </div>
        </div>
        <div class="ncbs-foot-nav-text  text-center">Intersections</div>
    </a>
    <br />
    <hr />

</div>
<div class="col-sm-12">
    <div class="text-center" style="margin-top:15px; font-family: roboto;">
        <a data-toggle="modal" data-target="#ncbs-content-policy" style="cursor: pointer;     color: #333726;">copyright &copy 2016</a>
    </div>
</div>
</div>
<!-- Modal -->
<div class="modal fade" id="ncbs-content-policy" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="font-family: roboto; border-radius:0px; color:darkcyan; background-color: #f2f2f2;">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel" style="font-family: roboto; ">User Agreement</h4>
      </div>
      <div class="modal-body">


     <p>This NCBS@25 digital exhibit contains records (images, audio and video excerpts, text) under copyright or under third party ownership. These records are given on loan to NCBS for the purposes of this exhibit. Material may only be reproduced with the explicit permission of the record owners, as mentioned in the caption for each image, and audio and video clip. The NCBS@25 About page has contact details. Any document without ownership details in the caption is in the public domain. Please respect the honour code and the generosity of the donors in sharing this material with a wider audience.
     </p>

     <p>Please click "ACCEPT" if you agree to comply with these terms. If you do not agree to comply with these terms, click "DECLINE" after which you will be redirected to the NCBS home page.</p>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal" style="color:#666;">Accept & Continue</button>
        <!--button type="button" class="btn btn-primary">Save changes</button-->
      </div>
    </div>
  </div>
</div>    </div>
  </div>
</div>




<script>

  //check for webgl


if (Modernizr.webgl) {

  //check for ie
  //need to improve this
  /**
   * detect IE
   * returns version of IE or false, if browser is not Internet Explorer
   */
  function detectIE() {
    var ua = window.navigator.userAgent;

    // Test values; Uncomment to check result …

    // IE 10
    // ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)';

    // IE 11
    // ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko';

    // Edge 12 (Spartan)
    // ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0';

    // Edge 13
    // ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586';

    var msie = ua.indexOf('MSIE ');
    if (msie > 0) {
      // IE 10 or older => return version number
      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }

    var trident = ua.indexOf('Trident/');
    if (trident > 0) {
      // IE 11 => return version number
      var rv = ua.indexOf('rv:');
      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }

    var edge = ua.indexOf('Edge/');
    if (edge > 0) {
      // Edge (IE 12+) => return version number
      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
    }

    // other browser
    return false;
  }

  var version = detectIE();

  if (version === false) {

  } else if (version >= 12) {

  } else {
    alert("Looks like you are using a browser that is not supported by space-tour. To experience space-tour please use the latest version of Chrome or Firefox");
  }


//pannellum viewer
pannellum.viewer('panorama', {

    "default": {
        "firstScene": "siddiqi_office_hdr",
        "sceneFadeDuration": 2000,
        "autoLoad": true,
        "hfov": 80,
    	"autoRotate": -0.4,
    	"autoRotateInactivityDelay": 40000,
    	"showFullscreenCtrl": false,
    	"showZoomCtrl": false,
    	"compass":false
    	//"hotSpotDebug": true
    },

    "scenes": {
        "siddiqi_office_hdr": {
            "title": "Obaid Siddiqi's Office ",
            "type": "equirectangular",
            "panorama": "panoramas/resized/siddiqi_office_hdr.jpg",
            "hotSpots": [
                {
                    "pitch": -12,
                    "yaw": 40,
                    "type": "info",
                    "text": "The reprint pile",
                    "URL": "#&q?i=reprints"
                },
                {
                    "pitch": -7,
                    "yaw": -140,
                    "type": "info",
                    "text": "On the lookout for trainee students",
                    "URL": "#&q?i=lookout"
                },
                {
                    "pitch": 0,
                    "yaw": 190,
                    "type": "scene",
                    "text": "Lab",
                    "sceneId": "1"
                }
            ]
        },

        "1": {
            "title": "Lab view 1",
            "panorama": "panoramas/resized/1.jpg",
            "yaw": 85,
            "hotSpots": [
                {
                    "pitch": -1,
                    "yaw": 85,
                    "type": "scene",
                    "text": "Obaid Siddiqi's Office",
                    "sceneId": "siddiqi_office_hdr"
                },
                {
                    "pitch": 0,
                    "yaw": 170,
                    "type": "scene",
                    "text": "Lab view 2",
                    "sceneId": "table_legs_hdr"
                },
                {
                    "pitch": -1,
                    "yaw": 88,
                    "type": "info",
                    "text": "Fly behaviour in a wind tunnel",
                    "URL": "#&q?i=wind"
                },
                {
                    "pitch": 15,
                    "yaw": 17,
                    "type": "info",
                    "text": "Patch clamp lab",
                    "URL": "#&q?i=patch"
                },
                {
                    "pitch": 16,
                    "yaw": -158,
                    "type": "info",
                    "text": "Interaction with support staff in Obaid Siddiqi's Lab",
                    "URL": "#&q?i=staff"
                },
            ]
        },

        "table_legs_hdr": {
            "title": "Lab view 2",
            "panorama": "panoramas/resized/table_legs_hdr.jpg",
            "hotSpots": [
                {
                    "pitch": 0,
                    "yaw": 50,
                    "type": "scene",
                    "text": "Lab view 1",
                    "sceneId": "1"
                },
                {
                    "pitch": 0,
                    "yaw": -50,
                    "type": "scene",
                    "text": "Lab view 3",
                    "sceneId": "2_hdr"
                },
                {
                    "pitch": -14,
                    "yaw": 13,
                    "type": "info",
                    "text": "Old electrode puller",
                    "URL": "#&q?i=electrode"
                },
                {
                    "pitch": -30,
                    "yaw": -60,
                    "type": "info",
                    "text": "Lab Meetings",
                    "URL": "#&q?i=meetings"
                }

            ]
        },

        "2_hdr": {
            "title": "Lab view 3",
            "panorama": "panoramas/resized/2_hdr.jpg",
            "yaw":-49,
            "hotSpots": [
                {
                    "pitch": 0,
                    "yaw": 100,
                    "type": "scene",
                    "text": "Lab view 2",
                    "sceneId": "table_legs_hdr"
                },
                 {
                    "pitch": 0.1,
                    "yaw": -73,
                    "type": "scene",
                    "text": "Lab view 4",
                    "sceneId": "3_hdr"
                },
                {
                    "pitch": 2,
                    "yaw": 20,
                    "type": "info",
                    "text": "Hand drawn graphs and verification of data",
                    "URL": "#&q?i=graphs"
                },
                {
                    "pitch": -14,
                    "yaw": -41,
                    "type": "info",
                    "text": "The 1999 flood",
                    "URL": "#&q?i=flood"
                }

            ]
        },

        "3_hdr": {
            "title": "Lab view 4",
            "panorama": "panoramas/resized/3_hdr.JPG",
            "hotSpots": [
                {
                    "pitch": 0,
                    "yaw": -100,
                    "type": "scene",
                    "text": "Lab view 3",
                    "sceneId": "2_hdr"
                },
                {
                    "pitch": 0.4,
                    "yaw": 7.8,
                    "type": "info",
                    "text": "Student Lab benches",
                    "URL": "#&q?i=benches"
                },
                {
                    "pitch": 2,
                    "yaw": -36,
                    "type": "info",
                    "text": "Fly maze apparatus",
                    "URL": "#&q?i=maze"
                },
                {
                    "pitch": 2.1,
                    "yaw": -82.9,
                    "type": "info",
                    "text": "Lab Spaces",
                    "URL": "#&q?i=spaces"
                }

            ]
        }


    }
});
}
else
{
  $("#intro").css("display", "none");
  alert("Looks like you're browser does not support WebGL. To experience space-tour fully, try using the latest version of chrome or firefox.");
}

</script>


<script>
//creates narrattion template
template = function(id){

	//clear previous content
	$("#title").innerHTML = '';
	//$("#contents").innerHTML = '';
    $("#contents").html('');


	//filter data
	var content = _.find(data, function(item, index, data){
  	return item.id === id;
	});


	//setup title
	var titleTemplate = _.template("<h4><%=title%></h4><br>");
	var titleData = titleTemplate({
    	title: content.title
  	});
	document.getElementById("title").innerHTML = titleData

	//setup content
	var contentTemplate = _.template(
	"<div id='space-at-the-top' class='space-at-the-top'></div>"+
	"<p class='description'><%=des%></p>"

	);
	var contentData = contentTemplate({
    	des: content.description
  	});
    appendToDom(contentData, "description");

    if(content.urls.audio){
        var icon = '<i class="fa fa-play-circle audio-player-trigger" aria-hidden="true" data-url='+content.urls.audio+'></i>';
        appendToDom(icon, "audio");

    }
    var imgTemplate = _.template("<div class='image-container'><div class='img-holder'><img  class='img' style='cursor: pointer; border:10px solid #000000;' src='<%=item%>'>"+
                "</div></div><br><br>");
    var audioTemplate = _.template("<div class='audio-container'><center><audio controls autoplay preload='auto' >"+
                "<source src='<%=url%>'> type='audio/mpeg'>"+
                "</audio></center></div>");

    if(content.urls.img){
        _.each(content.urls.img, function(item){
            var imgElm = imgTemplate({item:item});
            appendToDom(imgElm, "img");
        }, this);
    }

    function appendToDom(elm, type){
        $("#contents").append(elm);

        if(type == "audio"){
           if($('.audio-container').length != '0')
            {
                $('.audio-container').remove();
            }


            bindEvent();
        }

        if(type == 'img'){

            $(".img").on("click", function(event){
            console.log('ss');
            var viewer = ImageViewer(); //options is optional parameter
            var source = this.src;
            viewer.show(source);
        });

        }

    }
    window.clickCount = 0;
    function bindEvent(){
        $(".audio-player-trigger").on("click", function(event){
            if (clickCount == 0){
            var audioPlayerDom = audioTemplate(event.target.dataset);
            $('#audio-bar').append(audioPlayerDom);
            clickCount++;
        }
        else
        {

        }
        });
    }
	//document.getElementById("contents").innerHTML = contentData
};

</script>


<script>
//show
 routie('*/:name?', function(name) {

if(name.indexOf('&') > -1)
{
    window.temp = name.split('=');
    window.temp2 = temp[1];
    template(temp2);
    //document.getElementById('narration').style.display='block';
    //document.getElementById('title').style.display='block';
    //document.getElementById('close').style.display='block';
    if($("#narration").hasClass('movein')) {

        //$('#narration').removeClass('movein');
    }
    else{

        $('#narration').removeClass('moveout');
        $('#narration').addClass('movein');
    }
}


else if(name =='panorama'){
    window.location.hash="panorama";
}
else
    window.location.hash="";

});

//hide
//close fn
$( "#close" ).click(function() {
 //$("#close").css("display", "none");
 //$("#title").css("display", "none");
 //$("#narration").css("display", "none");
 window.location.hash="panorama";
 if($("#narration").hasClass('moveout')) {

        $('#narration').removeClass('moveout');
    }
    else{

        $('#narration').removeClass('movein');
        $('#narration').addClass('moveout');
    }

});


</script>

<script type="text/javascript">
    $( "#close-intro" ).click(function() {
    $("#intro").css("display", "none");
    //$("#close").css("display", "none");
});

</script>

</body>
</html>
